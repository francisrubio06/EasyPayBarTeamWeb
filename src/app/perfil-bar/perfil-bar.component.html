<app-nav-proveedor></app-nav-proveedor>
<div class="component-container">
  <div class="page-head">
    <i class="fa fa-chevron-left fa-3x" id="return" aria-hidden="true" routerLink="/menu-proveedor"></i>
    <h1 class="page-title">{{ titulo }}</h1>
  </div>
  <div class="page-main">
    <div class="page-section">
      <div class="col col-lg-5">
        <div class="work-container">
          <div class="work-container-head">
            Información del Bar
          </div>
          <div class="work-container-body">
            <label>Logo:</label>
            <img src="{{proveedor.imagenURL}}" alt="logoProveedor" *ngIf="proveedor != undefined">
            <img src="https://firebasestorage.googleapis.com/v0/b/easypaybar.appspot.com/o/assets%2Fring.gif?alt=media&token=f9839bf1-5a00-4db9-ac91-98e40b52a55b"
              style="width: 20%;" *ngIf="proveedor == undefined">
            <br>
            <label>Nombre del bar:</label>
            <div *ngIf="proveedor != undefined">{{ proveedor.bar }}</div>
            <br>
            <label>Dueño del bar:</label>
            <div *ngIf="proveedor != undefined">{{ proveedor.nombre }}</div>
            <hr>
            <button class="btn btn-primary btn-sm" (click)="openModalBarEditar()"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Editar</button>
          </div>
        </div>
      </div>
      <div class="col col-lg-7">
        <div class="work-container">
          <div class="work-container-head">
            Clientes afiliados
          </div>
          <div class="work-container-body">
            <img src="https://firebasestorage.googleapis.com/v0/b/easypaybar.appspot.com/o/assets%2Fring.gif?alt=media&token=f9839bf1-5a00-4db9-ac91-98e40b52a55b"
              style="width: 20%;" *ngIf="listAfiliados == undefined">
            <table class="table table-hovered" *ngIf="listAfiliados != undefined">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Saldo</th>
                  <th>Fecha afiliación</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let afiliado of listAfiliados | paginate: { itemsPerPage: 3, currentPage: pageAfiliado }">
                  <td>{{afiliado.nombre}}</td>
                  <td>{{afiliado.saldo}} $</td>
                  <td>{{afiliado.fechaAfiliacion}}</td>
                </tr>
              </tbody>
            </table>
            <!-- Pagination -->
            <pagination-controls (pageChange)="pageAfiliado = $event" *ngIf="listAfiliados != undefined"></pagination-controls>
          </div>
        </div>
        <div class="work-container">
          <div class="work-container-head">
            Compras realizadas
          </div>
          <div class="work-container-body">
            <img src="https://firebasestorage.googleapis.com/v0/b/easypaybar.appspot.com/o/assets%2Fring.gif?alt=media&token=f9839bf1-5a00-4db9-ac91-98e40b52a55b"
              style="width: 20%;" *ngIf="listAfiliados == undefined">
            <table class="table table-hovered" *ngIf="listAfiliados != undefined">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Total</th>
                  <th>Fecha</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let compra of comprasRealizadas | paginate: { itemsPerPage: 3, currentPage: page }">
                  <td>{{compra.total}}</td>
                </tr>
              </tbody>
            </table>
            <!-- Pagination -->
            <pagination-controls (pageChange)="page = $event" *ngIf="listAfiliados != undefined"></pagination-controls>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Modal Editar -->
<modal #modalBarEditar *ngIf="proveedor != undefined">
  <modal-header [show-close]="false">
    <h4 class="modal-title">¿Qué cambios desea realizar?</h4>
  </modal-header>

  <modal-body class="form-horizontal">
    <div class="form-group">
      <label class="col-lg-2 control-label"><h5><b>Nombre del bar:</b></h5></label>
      <div class="col-lg-9">
        <input type="text" class="form-control" name="txtnombre" [value]="proveedor.bar" [(ngModel)]="proveedor.bar"
          placeholder="Ingrese el nombre del bar" #nombre="ngModel" required />
        <span style="color:#e74c3c;" *ngIf="nombre.errors?.required"><p>El nombre es requerido.</p></span>
      </div>
    </div>

    <div class="form-group">
      <label class="col-lg-2 control-label"><h5><b>Logo:</b></h5></label>
      <div class="col-lg-9">
        <input type="file" name="file" id="file" (change)="seleccionarImagen($event)" />
      </div>
    </div>
  </modal-body>

  <modal-footer>
    <div *ngIf="nombre.errors">
      <button type="button" class="btn btn-primary col-lg-5" disabled><i class="fa fa-check" aria-hidden="true"></i> Confirmar</button>
    </div>
    <div *ngIf="!nombre.errors">
      <button type="button" class="btn btn-primary col-lg-5" data-dismiss="modal" (click)="actualizarBar()"><i class="fa fa-check" aria-hidden="true"></i> Confirmar</button>
    </div>
    <button type="button" class="btn btn-danger col-lg-5" (click)="modalEditar.close()"><i class="fa fa-times" aria-hidden="true"></i> Cancelar</button>
  </modal-footer>
</modal>